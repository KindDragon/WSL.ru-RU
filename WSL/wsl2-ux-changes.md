---
title: Изменения UX между WSL 1 и WSL 2
description: Изменения взаимодействия с пользователем между WSL 1 и WSL 2
keywords: Башонвиндовс, bash, WSL, wsl2, Windows, подсистема Windows для Linux, виндовссубсистем, Ubuntu, Debian, SUSE, Windows 10
ms.date: 05/30/2019
ms.topic: article
ms.assetid: 7afaeacf-435a-4e58-bff0-a9f0d75b8a51
ms.custom: seodec18
ms.openlocfilehash: a8f298a69acf44f152da626a0ba571f6bba1970c
ms.sourcegitcommit: 07eb5f2e1f4517928165dda4510012599b0d0e1e
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 01/22/2020
ms.locfileid: "76520563"
---
# <a name="user-experience-changes-between-wsl-1-and-wsl-2"></a><span data-ttu-id="2c4e8-104">Изменения взаимодействия с пользователем между WSL 1 и WSL 2</span><span class="sxs-lookup"><span data-stu-id="2c4e8-104">User Experience Changes Between WSL 1 and WSL 2</span></span>

<span data-ttu-id="2c4e8-105">На этой странице рассматриваются различия в работе пользователей между WSL 1 и предварительной версией WSL 2.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-105">This page goes over the user experience differences between WSL 1 and the WSL 2 preview.</span></span> <span data-ttu-id="2c4e8-106">Основные изменения, которые следует учитывать:</span><span class="sxs-lookup"><span data-stu-id="2c4e8-106">The key changes to be aware of are:</span></span>

- <span data-ttu-id="2c4e8-107">Размещайте файлы, к которым приложения Linux будут обращаться в корневой файловой системе Linux, для ускорения производительности файлов</span><span class="sxs-lookup"><span data-stu-id="2c4e8-107">Place files that your Linux apps will access in your Linux root file system for faster file performance speed</span></span>
- <span data-ttu-id="2c4e8-108">В начальных сборках предварительной версии WSL 2 необходимо получить доступ к сетевым приложениям, используя IP-адрес, а не использовать localhost.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-108">In initial builds of the WSL 2 preview you will need to access network applications using an IP address and not using localhost</span></span>

<span data-ttu-id="2c4e8-109">Ниже приведен полный список других изменений, которые вы можете заметить:</span><span class="sxs-lookup"><span data-stu-id="2c4e8-109">And below is the full list of other changes that you may notice:</span></span>

- <span data-ttu-id="2c4e8-110">WSL 2 использует [виртуальный диск](https://en.wikipedia.org/wiki/VHD_(file_format)) (VHD) для хранения файлов и, если достигнут максимальный размер, может потребоваться развернуть его.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-110">WSL 2 uses a [Virtual Hardware Disk](https://en.wikipedia.org/wiki/VHD_(file_format)) (VHD) to store your files and if you reach its max size you may need to expand it</span></span>
- <span data-ttu-id="2c4e8-111">При запуске WSL 2 теперь будет использовать небольшую долю памяти.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-111">When starting, WSL 2 will now use a small proportion of memory</span></span>
- <span data-ttu-id="2c4e8-112">Скорость доступа к файлам между операционными системами будет ниже в первоначальных сборках предварительной версии</span><span class="sxs-lookup"><span data-stu-id="2c4e8-112">Cross OS file access speed will be slower in initial preview builds</span></span>

## <a name="place-your-linux-files-in-your-linux-root-file-system"></a><span data-ttu-id="2c4e8-113">Размещение файлов Linux в корневой файловой системе Linux</span><span class="sxs-lookup"><span data-stu-id="2c4e8-113">Place your Linux files in your Linux root file system</span></span>
<span data-ttu-id="2c4e8-114">Обязательно помещайте файлы, к которым будет осуществляться доступ, с помощью приложений Linux в корневой файловой системе Linux, чтобы получить преимущества производительности файлов.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-114">Make sure to put the files that you will be accessing frequently with Linux applications inside of your Linux root file system to enjoy the file performance benefits.</span></span> <span data-ttu-id="2c4e8-115">Для ускорения доступа к файловой системе эти файлы должны находиться в корневой файловой системе Linux.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-115">These files have to be inside of the Linux root file system to have faster file system access.</span></span> <span data-ttu-id="2c4e8-116">Мы также сделали так, чтобы приложения Windows могли получить доступ к корневой файловой системе Linux (например, в проводнике).</span><span class="sxs-lookup"><span data-stu-id="2c4e8-116">We have also made it possible for Windows apps to access the Linux root file system (like File Explorer!</span></span> <span data-ttu-id="2c4e8-117">Попробуйте выполнить: `explorer.exe .` в домашнем каталоге дистрибутив Linux и посмотрите, что произойдет, что сделает этот переход значительно проще.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-117">Try running: `explorer.exe .` in the home directory of your Linux distro and see what happens) which will make this transition significantly easier.</span></span> 

## <a name="accessing-network-applications"></a><span data-ttu-id="2c4e8-118">Доступ к сетевым приложениям</span><span class="sxs-lookup"><span data-stu-id="2c4e8-118">Accessing network applications</span></span>
<span data-ttu-id="2c4e8-119">В начальных сборках предварительной версии WSL 2 необходимо получить доступ к любому серверу Windows Server из Linux, используя IP-адрес главного компьютера.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-119">In the initial builds of the WSL 2 preview, you will need to access any Windows server from Linux using the IP address of your host machine.</span></span>

### <a name="accessing-windows-applications-from-linux"></a><span data-ttu-id="2c4e8-120">Доступ к приложениям Windows из Linux</span><span class="sxs-lookup"><span data-stu-id="2c4e8-120">Accessing Windows applications from Linux</span></span>
<span data-ttu-id="2c4e8-121">Для доступа к сетевому приложению Windows необходимо использовать IP-адрес главного компьютера.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-121">To access a Windows network application you'll need to use the IP address of your host machine.</span></span> <span data-ttu-id="2c4e8-122">Это можно сделать, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-122">You can do so with these steps:</span></span>

- <span data-ttu-id="2c4e8-123">Получите IP-адрес главного компьютера, выполнив команду `cat /etc/resolv.conf` и скопировав IP-адрес после термина `nameserver`.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-123">Obtain the IP address of your host machine by running the command `cat /etc/resolv.conf` and copying the IP address following the term `nameserver`.</span></span> 
- <span data-ttu-id="2c4e8-124">Подключитесь к любому серверу Windows Server, используя скопированный IP-адрес.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-124">Connect to any Windows server using the copied IP address.</span></span>

<span data-ttu-id="2c4e8-125">На рисунке ниже показан пример подключения к серверу Node. js под управлением Windows через фигуру.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-125">The picture below shows an example of this by connecting to a Node.js server running in Windows via curl.</span></span> 

![Доступ к сетевым приложениям Linux из Windows](media/wsl2-network-l2w.png)

### <a name="accessing-linux-applications-from-windows"></a><span data-ttu-id="2c4e8-127">Доступ к приложениям Linux из Windows</span><span class="sxs-lookup"><span data-stu-id="2c4e8-127">Accessing Linux applications from Windows</span></span>

<span data-ttu-id="2c4e8-128">В зависимости от используемой версии Windows может потребоваться получить IP-адрес виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-128">Depending on which version of Windows you're using, you might need to retrieve the IP address of the virtual machine.</span></span> <span data-ttu-id="2c4e8-129">Если сборка имеет значение 18945 или более поздней версии, можно использовать `localhost` так же, как и обычные.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-129">If your build is 18945 or higher, you can use `localhost` just like normal.</span></span> 

#### <a name="accessing-linux-on-builds-lower-than-18945httpsblogswindowscomwindowsexperience20190726announcing-windows-10-insider-preview-build-18945"></a><span data-ttu-id="2c4e8-130">Доступ к Linux в сборках ниже [18945](https://blogs.windows.com/windowsexperience/2019/07/26/announcing-windows-10-insider-preview-build-18945/)</span><span class="sxs-lookup"><span data-stu-id="2c4e8-130">Accessing Linux on Builds lower than [18945](https://blogs.windows.com/windowsexperience/2019/07/26/announcing-windows-10-insider-preview-build-18945/)</span></span>

<span data-ttu-id="2c4e8-131">Если у вас есть сервер в WSL дистрибутив, вам потребуется найти IP-адрес виртуальной машины, чтобы подключить дистрибутив, и подключиться к нему по этому IP-адресу.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-131">If you have a server in a WSL distro, you'll need to find the IP address of the virtual machine powering your distro and connect to it with that IP address.</span></span> <span data-ttu-id="2c4e8-132">Это можно сделать, выполнив следующие действия.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-132">You can do that by following these steps:</span></span>

- <span data-ttu-id="2c4e8-133">Получите IP-адрес дистрибутив, выполнив команду `ip addr` внутри WSL дистрибутив и находя ее в `inet`е `eth0` интерфейса.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-133">Obtain the IP address of your distro by running the command `ip addr` inside of your WSL distro and finding it under the `inet` value of the `eth0` interface.</span></span>
   - <span data-ttu-id="2c4e8-134">Это проще всего сделать, отфильтрая выходные данные команды с помощью GREP следующим образом: `ip addr | grep eth0`.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-134">You can find this more easily by filtering the output of the command using grep like so: `ip addr | grep eth0`.</span></span>
- <span data-ttu-id="2c4e8-135">Подключитесь к серверу Linux с помощью указанного выше IP-адреса.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-135">Connect to your Linux server using the IP you found above.</span></span>

<span data-ttu-id="2c4e8-136">На рисунке ниже показан пример подключения к серверу Node. js с помощью браузера Microsoft ребра.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-136">The picture below shows an example of this by connecting to a Node.js server using the Edge browser.</span></span>

![Доступ к сетевым приложениям Linux из Windows](media/wsl2-network-w2l.jpg)

### <a name="other-networking-considerations"></a><span data-ttu-id="2c4e8-138">Другие аспекты работы с сетью</span><span class="sxs-lookup"><span data-stu-id="2c4e8-138">Other networking considerations</span></span>

#### <a name="connecting-via-remote-ip-addresses"></a><span data-ttu-id="2c4e8-139">Подключение через удаленные IP-адреса</span><span class="sxs-lookup"><span data-stu-id="2c4e8-139">Connecting via remote IP addresses</span></span>

<span data-ttu-id="2c4e8-140">При использовании удаленных IP-адресов для подключения к приложениям они будут рассматриваться как подключения из локальной сети (LAN).</span><span class="sxs-lookup"><span data-stu-id="2c4e8-140">When using remote IP addresses to connect to your applications, they will be treated as connections from the Local Area Network (LAN).</span></span> <span data-ttu-id="2c4e8-141">Это означает, что необходимо убедиться, что приложение может принимать подключения по локальной сети, т. е. может потребоваться привязать приложение к `0.0.0.0` вместо `127.0.0.1`.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-141">This means that you will need to make sure your application can accept LAN connections, i.e: You might need to bind your application to `0.0.0.0` instead of `127.0.0.1`.</span></span> <span data-ttu-id="2c4e8-142">Например, в Python с помощью Flask это можно сделать с помощью команды: `app.run(host='0.0.0.0')`.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-142">For example in python using flask this can be done with the command: `app.run(host='0.0.0.0')`.</span></span> <span data-ttu-id="2c4e8-143">При внесении этих изменений учитывайте безопасность, так как это позволит устанавливать подключения из локальной сети.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-143">Please keep security in mind when making these changes, as this will allow connections from your LAN.</span></span> 

#### <a name="accessing-a-wsl2-distro-from-your-local-area-network-lan"></a><span data-ttu-id="2c4e8-144">Доступ к WSL2 дистрибутив из локальной сети (LAN)</span><span class="sxs-lookup"><span data-stu-id="2c4e8-144">Accessing a WSL2 distro from your local area network (LAN)</span></span>

<span data-ttu-id="2c4e8-145">При использовании WSL1 дистрибутив, если компьютер был настроен для доступа в локальной сети, приложения, работающие в WSL, могут быть доступны в локальной сети.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-145">When using a WSL1 distro, if your computer was set up to be accessed by in your LAN, then applications run in WSL could be accessed on your LAN as well.</span></span> <span data-ttu-id="2c4e8-146">Этот вариант не используется по умолчанию в WSL2, так как WSL2 содержит виртуализованный адаптер Ethernet с собственным IP-адресом.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-146">This isn't the default case in WSL2, as WSL2 has a virtualized ethernet adapter with its own IP address.</span></span> <span data-ttu-id="2c4e8-147">В настоящее время для включения этого рабочего процесса необходимо выполнить те же действия, что и для обычной виртуальной машины.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-147">Currently, to enable this workflow you will need to go through the same steps as you would for a regular virtual machine.</span></span> <span data-ttu-id="2c4e8-148">Мы рассмотрим способы улучшения этого интерфейса!</span><span class="sxs-lookup"><span data-stu-id="2c4e8-148">We are looking into ways to improve this experience!</span></span>

#### <a name="ipv6-access"></a><span data-ttu-id="2c4e8-149">Доступ по протоколу IPv6</span><span class="sxs-lookup"><span data-stu-id="2c4e8-149">IPv6 access</span></span>

<span data-ttu-id="2c4e8-150">В настоящее время WSL2 дистрибутивов не может связаться только с IPv6-адресами.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-150">WSL2 distros currently cannot reach IPv6 only addresses.</span></span> <span data-ttu-id="2c4e8-151">Мы работаем над добавлением этой функции.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-151">We are working on adding this feature.</span></span>

## <a name="understanding-wsl-2-uses-a-vhd-and-what-to-do-if-you-reach-its-max-size"></a><span data-ttu-id="2c4e8-152">Понимание WSL 2 использует виртуальный жесткий диск и что делать, если достигнут максимальный размер</span><span class="sxs-lookup"><span data-stu-id="2c4e8-152">Understanding WSL 2 uses a VHD, and what to do if you reach its max size</span></span>
<span data-ttu-id="2c4e8-153">WSL 2 сохраняет все файлы Linux в виртуальном жестком диске, использующем файловую систему ext4.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-153">WSL 2 stores all your Linux files inside of a VHD that uses the ext4 file system.</span></span> <span data-ttu-id="2c4e8-154">Размер этого виртуального жесткого диска автоматически изменяется в соответствии с потребностями хранилища.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-154">This VHD automatically resizes to meet your storage needs.</span></span> <span data-ttu-id="2c4e8-155">Этот виртуальный жесткий диск также имеет исходный максимальный размер 256 ГБ.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-155">This VHD also has an initial max size of 256GB.</span></span> <span data-ttu-id="2c4e8-156">Если размер дистрибутив увеличился, чем 256 ГБ, вы увидите сообщение об ошибке, сообщающее, что закончилось место на диске.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-156">If your distro grows in size to be greater than 256GB you will see errors stating that you've run out of disk space.</span></span> <span data-ttu-id="2c4e8-157">Их можно исправить, развернув размер виртуального жесткого диска.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-157">You can fix these by expanding the VHD size.</span></span> <span data-ttu-id="2c4e8-158">Ниже приведены инструкции о том, как это сделать.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-158">Instructions on how to do so are below:</span></span>

1. <span data-ttu-id="2c4e8-159">Завершение работы всех экземпляров WSL с помощью команды `wsl --shutdown`</span><span class="sxs-lookup"><span data-stu-id="2c4e8-159">Terminate all WSL instances using the `wsl --shutdown` command</span></span>
2. <span data-ttu-id="2c4e8-160">Найдите имя пакета установки дистрибутив "PackageFamilyName"</span><span class="sxs-lookup"><span data-stu-id="2c4e8-160">Find your distro installation package name 'PackageFamilyName'</span></span>
   - <span data-ttu-id="2c4e8-161">В командной строке PowerShell (где "\<distro\>" — имя распространения):</span><span class="sxs-lookup"><span data-stu-id="2c4e8-161">In a powershell prompt (where 'distro' is your distribution name) type:</span></span>
      - `Get-AppxPackage -Name "*<distro>*" | Select PackageFamilyName`
3. <span data-ttu-id="2c4e8-162">Выберите файл виртуального жесткого диска, используемый для установки WSL 2. это будет "pathToVHD":</span><span class="sxs-lookup"><span data-stu-id="2c4e8-162">Locate the VHD file fullpath used by your WSL 2 installation, this will be your 'pathToVHD':</span></span>
     - `%LOCALAPPDATA%\Packages\<PackageFamilyName>\LocalState\<disk>.vhdx`
4. <span data-ttu-id="2c4e8-163">Измените размер виртуального жесткого диска WSL 2, выполнив следующие команды.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-163">Resize your WSL 2 VHD by completing the following commands</span></span>
   - <span data-ttu-id="2c4e8-164">Откройте окно командной строки с правами администратора и выполните следующие команды:</span><span class="sxs-lookup"><span data-stu-id="2c4e8-164">Open a command prompt Window with admin privileges and run the following commands:</span></span>
      - `diskpart`
      - `Select vdisk file="<pathToVHD>"`
      - `expand vdisk maximum="<sizeInMegaBytes>"`
5. <span data-ttu-id="2c4e8-165">Запуск дистрибутив WSL</span><span class="sxs-lookup"><span data-stu-id="2c4e8-165">Launch your WSL distro</span></span>
6. <span data-ttu-id="2c4e8-166">Сделайте WSL, чтобы он мог расширить свой размер файловой системы.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-166">Make WSL aware that it can expand its file system's size</span></span>
   - <span data-ttu-id="2c4e8-167">Выполните следующие команды в WSL дистрибутив:</span><span class="sxs-lookup"><span data-stu-id="2c4e8-167">Run these commands in your WSL distro:</span></span>
      - `sudo mount -t devtmpfs none /dev`
      - `mount | grep ext4`
         - <span data-ttu-id="2c4e8-168">Скопируйте имя этой записи, которая будет выглядеть следующим образом:/Дев/сдкскс (с X, представляющим любой другой символ).</span><span class="sxs-lookup"><span data-stu-id="2c4e8-168">Copy the name of this entry, which will look like: /dev/sdXX (with the X representing any other character)</span></span>
      - `sudo resize2fs /dev/sdXX`
         - <span data-ttu-id="2c4e8-169">Обязательно используйте скопированное ранее значение. возможно, потребуется использовать: `apt install resize2fs`.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-169">Make sure to use the value you copied earlier, and you may need to use: `apt install resize2fs`.</span></span>

<span data-ttu-id="2c4e8-170">Примечание. в общем случае не изменяйте, не перемещая и не обращайтесь к файлам, связанным с WSL, расположенным внутри папки AppData, с помощью инструментов или редакторов Windows.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-170">Please note: In general do not modify, move, or access the WSL related files located inside of your AppData folder using Windows tools or editors.</span></span> <span data-ttu-id="2c4e8-171">Это может привести к повреждению дистрибутив Linux.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-171">Doing so could cause your Linux distro to become corrupted.</span></span>

## <a name="wsl-2-will-use-some-memory-on-startup"></a><span data-ttu-id="2c4e8-172">WSL 2 будет использовать некоторый объем памяти при запуске</span><span class="sxs-lookup"><span data-stu-id="2c4e8-172">WSL 2 will use some memory on startup</span></span>
<span data-ttu-id="2c4e8-173">WSL 2 использует упрощенную служебную виртуальную машину на реальном ядре Linux, чтобы обеспечить высокую производительность файловой системы и полную совместимость системных вызовов, не так как это просто простой, быстрый, интегрированный и реагирующий на запросы как WSL 1.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-173">WSL 2 uses a lightweight utility VM on a real Linux kernel to provide great file system performance and full system call compatibility while still being just as light, fast, integrated and responsive as WSL 1.</span></span> <span data-ttu-id="2c4e8-174">Эта служебная виртуальная машина имеет небольшой объем памяти и выделит память с виртуальным адресом при запуске.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-174">This utility VM has a small memory footprint and will allocate Virtual Address backed memory on startup.</span></span> <span data-ttu-id="2c4e8-175">Она должна начинаться с небольшой доли от общего объема памяти.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-175">It is configured to start with a small proportion of your total memory.</span></span>

## <a name="cross-os-file-speed-will-be-slower-in-initial-preview-builds"></a><span data-ttu-id="2c4e8-176">Скорость файлов между операционными системами будет более низкой в первоначальных сборках предварительной версии</span><span class="sxs-lookup"><span data-stu-id="2c4e8-176">Cross OS file speed will be slower in initial preview builds</span></span>
<span data-ttu-id="2c4e8-177">Вы увидите медленные файлы по сравнению с WSL 1 при доступе к файлам Windows из приложения Linux или доступе к файлам Linux из приложения Windows.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-177">You will notice slower file speeds compared to WSL 1 when accessing Windows files from a Linux application, or accessing Linux files from a Windows application.</span></span> <span data-ttu-id="2c4e8-178">Это результат изменения архитектуры в WSL 2, и группа WSL активно изучает, как мы можем улучшить этот процесс.</span><span class="sxs-lookup"><span data-stu-id="2c4e8-178">This is a result of the architectural changes in WSL 2, and is something that the WSL team is actively investigating on how we can improve this experience.</span></span>
