---
title: Изменения UX между WSL 1 и WSL 2
description: Изменения взаимодействия с пользователем между WSL 1 и WSL 2
keywords: Башонвиндовс, bash, WSL, wsl2, Windows, подсистема Windows для Linux, виндовссубсистем, Ubuntu, Debian, SUSE, Windows 10
ms.date: 05/30/2019
ms.topic: article
ms.assetid: 7afaeacf-435a-4e58-bff0-a9f0d75b8a51
ms.custom: seodec18
ms.openlocfilehash: 635e4335bd3fe5dd1629faba0168ec4fa331e190
ms.sourcegitcommit: 6f6b7b67dd35b5fc7b582bb7ac27b9936dedb23d
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 12/02/2019
ms.locfileid: "74681646"
---
# <a name="user-experience-changes-between-wsl-1-and-wsl-2"></a>Изменения взаимодействия с пользователем между WSL 1 и WSL 2

На этой странице рассматриваются различия в работе пользователей между WSL 1 и предварительной версией WSL 2. Основные изменения, которые следует учитывать:

- Размещайте файлы, к которым приложения Linux будут обращаться в корневой файловой системе Linux, для ускорения производительности файлов
- В начальных сборках предварительной версии WSL 2 необходимо получить доступ к сетевым приложениям, используя IP-адрес, а не использовать localhost.

Ниже приведен полный список других изменений, которые вы можете заметить:

- WSL 2 использует [виртуальный диск](https://en.wikipedia.org/wiki/VHD_(file_format)) (VHD) для хранения файлов и, если достигнут максимальный размер, может потребоваться развернуть его.
- При запуске WSL 2 теперь будет использовать небольшую долю памяти.
- Скорость доступа к файлам между операционными системами будет ниже в первоначальных сборках предварительной версии

## <a name="place-your-linux-files-in-your-linux-root-file-system"></a>Размещение файлов Linux в корневой файловой системе Linux
Обязательно помещайте файлы, к которым будет осуществляться доступ, с помощью приложений Linux в корневой файловой системе Linux, чтобы получить преимущества производительности файлов. Для ускорения доступа к файловой системе эти файлы должны находиться в корневой файловой системе Linux. Мы также сделали так, чтобы приложения Windows могли получить доступ к корневой файловой системе Linux (например, в проводнике). Попробуйте выполнить: `explorer.exe .` в домашнем каталоге дистрибутив Linux и посмотрите, что произойдет, что сделает этот переход значительно проще. 

## <a name="accessing-network-applications"></a>Доступ к сетевым приложениям
В начальных сборках предварительной версии WSL 2 необходимо получить доступ к любому серверу Windows Server из Linux, используя IP-адрес главного компьютера.

### <a name="accessing-windows-applications-from-linux"></a>Доступ к приложениям Windows из Linux
Для доступа к сетевому приложению Windows необходимо использовать IP-адрес главного компьютера. Это можно сделать, выполнив следующие действия.

- Получите IP-адрес главного компьютера, выполнив команду `cat /etc/resolv.conf` и скопировав IP-адрес после термина `nameserver`. 
- Подключитесь к любому серверу Windows Server, используя скопированный IP-адрес.

На рисунке ниже показан пример подключения к серверу Node. js под управлением Windows через фигуру. 

![Доступ к сетевым приложениям Linux из Windows](media/wsl2-network-l2w.png)

### <a name="accessing-linux-applications-from-windows-only-in-builds-lower-than-18945"></a>Доступ к приложениям Linux из Windows (только в сборках ниже 18945)
Если у вас есть сервер в WSL дистрибутив, вам потребуется найти IP-адрес виртуальной машины, чтобы подключить дистрибутив, и подключиться к нему по этому IP-адресу. Это можно сделать, выполнив следующие действия.

- Получите IP-адрес дистрибутив, выполнив команду `ip addr` внутри WSL дистрибутив и находя ее в `inet`е `eth0` интерфейса.
   - Это проще всего сделать, отфильтрая выходные данные команды с помощью GREP следующим образом: `ip addr | grep eth0`.
- Подключитесь к серверу Linux с помощью указанного выше IP-адреса.

На рисунке ниже показан пример подключения к серверу Node. js с помощью браузера Microsoft ребра.

![Доступ к сетевым приложениям Linux из Windows](media/wsl2-network-w2l.jpg)

Если сборка имеет значение 18945 или более поздней версии, то можно использовать localhost так же, как и обычные. 

### <a name="other-networking-considerations"></a>Другие аспекты работы с сетью

#### <a name="connecting-via-remote-ip-addresses"></a>Подключение через удаленные IP-адреса

При использовании удаленных IP-адресов для подключения к приложениям они будут рассматриваться как подключения из локальной сети (LAN). Это означает, что необходимо убедиться, что приложение может принимать подключения по локальной сети, т. е. может потребоваться привязать приложение к `0.0.0.0` вместо `127.0.0.1`. Например, в Python с помощью Flask это можно сделать с помощью команды: `app.run(host='0.0.0.0')`. При внесении этих изменений учитывайте безопасность, так как это позволит устанавливать подключения из локальной сети. 

#### <a name="accessing-a-wsl2-distro-from-your-local-area-network-lan"></a>Доступ к WSL2 дистрибутив из локальной сети (LAN)

При использовании WSL1 дистрибутив, если компьютер был настроен для доступа в локальной сети, приложения, работающие в WSL, могут быть доступны в локальной сети. Этот вариант не используется по умолчанию в WSL2, так как WSL2 содержит виртуализованный адаптер Ethernet с собственным IP-адресом. В настоящее время для включения этого рабочего процесса необходимо выполнить те же действия, что и для обычной виртуальной машины. Мы рассмотрим способы улучшения этого интерфейса!

#### <a name="ipv6-access"></a>Доступ по протоколу IPv6

В настоящее время WSL2 дистрибутивов не может связаться только с IPv6-адресами. Мы работаем над добавлением этой функции.

## <a name="understanding-wsl-2-uses-a-vhd-and-what-to-do-if-you-reach-its-max-size"></a>Понимание WSL 2 использует виртуальный жесткий диск и что делать, если достигнут максимальный размер
WSL 2 сохраняет все файлы Linux в виртуальном жестком диске, использующем файловую систему ext4. Размер этого виртуального жесткого диска автоматически изменяется в соответствии с потребностями хранилища. Этот виртуальный жесткий диск также имеет исходный максимальный размер 256 ГБ. Если размер дистрибутив увеличился, чем 256 ГБ, вы увидите сообщение об ошибке, сообщающее, что закончилось место на диске. Их можно исправить, развернув размер виртуального жесткого диска. Ниже приведены инструкции о том, как это сделать.

1. Завершение работы всех экземпляров WSL с помощью команды `wsl --shutdown`
2. Найдите имя пакета установки дистрибутив "Паккажефамилинаме"
   - В командной строке PowerShell (где "дистрибутив" — имя распространения):
      - `Get-AppxPackage -Name "*<distro>*" | Select PackageFamilyName`
3. Выберите файл виртуального жесткого диска, используемый для установки WSL 2. это будет "Пастовхд":
     - `%LOCALAPPDATA%\Packages\<PackageFamilyName>\LocalState\<disk>.vhdx`
4. Измените размер виртуального жесткого диска WSL 2, выполнив следующие команды.
   - Откройте окно командной строки с правами администратора и выполните следующие команды:
      - `diskpart`
      - `Select vdisk file="<pathToVHD>"`
      - `expand vdisk maximum="<sizeInMegaBytes>"`
5. Запуск дистрибутив WSL
6. Сделайте WSL, чтобы он мог расширить свой размер файловой системы.
   - Выполните следующие команды в WSL дистрибутив:
      - `sudo mount -t devtmpfs none /dev`
      - `mount | grep ext4`
         - Скопируйте имя этой записи, которая будет выглядеть следующим образом:/Дев/сдкскс (с X, представляющим любой другой символ).
      - `sudo resize2fs /dev/sdXX`
         - Обязательно используйте скопированное ранее значение. возможно, потребуется использовать: `apt install resize2fs`.

Примечание. в общем случае не изменяйте, не перемещая и не обращайтесь к файлам, связанным с WSL, расположенным внутри папки AppData, с помощью инструментов или редакторов Windows. Это может привести к повреждению дистрибутив Linux.

## <a name="wsl-2-will-use-some-memory-on-startup"></a>WSL 2 будет использовать некоторый объем памяти при запуске
WSL 2 использует упрощенную служебную виртуальную машину на реальном ядре Linux, чтобы обеспечить высокую производительность файловой системы и полную совместимость системных вызовов, не так как это просто простой, быстрый, интегрированный и реагирующий на запросы как WSL 1. Эта служебная виртуальная машина имеет небольшой объем памяти и выделит память с виртуальным адресом при запуске. Она должна начинаться с небольшой доли от общего объема памяти.

## <a name="cross-os-file-speed-will-be-slower-in-initial-preview-builds"></a>Скорость файлов между операционными системами будет более низкой в первоначальных сборках предварительной версии
Вы увидите медленные файлы по сравнению с WSL 1 при доступе к файлам Windows из приложения Linux или доступе к файлам Linux из приложения Windows. Это результат изменения архитектуры в WSL 2, и группа WSL активно изучает, как мы можем улучшить этот процесс.
